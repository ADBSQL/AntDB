set grammar to oracle;
set datestyle='ISO,YMD';
select decode(to_char(45),'3','9','45','3') from dual;
 DECODE(TO_CHAR(45),'3','9','45','3') 
--------------------------------------
 3
(1 row)

select decode(1.5*3,3.0,4,4.5,4.5) from dual;
 DECODE(1.5*3,3.0,4,4.5,4.5) 
-----------------------------
                         4.5
(1 row)

select decode(3,4,4,3,6) from dual;
 DECODE(3,4,4,3,6) 
-------------------
                 6
(1 row)

select decode('a','a','b','a') from dual;
 DECODE('A','A','B','A') 
-------------------------
 b
(1 row)

select decode('你好','你好','b','a') as str from dual;
 STR 
-----
 b
(1 row)

select decode(to_number('2'),2,3,'2',4) from dual;
 DECODE(TO_NUMBER('2'),2,3,'2',4) 
----------------------------------
                                3
(1 row)

select decode(to_number('2.4'),2.3,4,'2.4',4) from dual;
 DECODE(TO_NUMBER('2.4'),2.3,4,'2.4',4) 
----------------------------------------
                                      4
(1 row)

select decode(4,to_char('a'),4,'b',5) from dual;
 DECODE(4,TO_CHAR('A'),4,'B',5) 
--------------------------------
                               
(1 row)

select decode(to_char('5'),to_char('5'),to_char('6'),to_char('6'),to_char('7')) from dual;
 DECODE(TO_CHAR('5'),TO_CHAR('5'),TO_CHAR('6'),TO_CHAR('6'),TO_CHAR('7')) 
--------------------------------------------------------------------------
 6
(1 row)

select decode(3,exp(2),4,5) from dual;
 DECODE(3,EXP(2),4,5) 
----------------------
                    5
(1 row)

select decode(exp(2),7,4,5) from dual;
 DECODE(EXP(2),7,4,5) 
----------------------
                    5
(1 row)

select decode('3',tanh(3),4,5) from dual;
 DECODE('3',TANH(3),4,5) 
-------------------------
                       5
(1 row)

select decode('3',3,4,5) from dual;
 DECODE('3',3,4,5) 
-------------------
                 4
(1 row)

select decode(3,'3',4,5) from dual;
 DECODE(3,'3',4,5) 
-------------------
                 4
(1 row)

select decode('3',3.0,4,5) from dual;
 DECODE('3',3.0,4,5) 
---------------------
                   4
(1 row)

select decode('a','a','2',1,3) from dual;
 DECODE('A','A','2',1,3) 
-------------------------
                       2
(1 row)

select decode(to_date('2007-1-1','yyyy-mm-dd'),to_date('2007-1-1','yyyy-mm-dd'),1,0) from dual;
 DECODE(TO_DATE('2007-1-1','YYYY-MM-DD'),TO_DATE('2007-1-1','YYYY-MM-DD'),1,0) 
-------------------------------------------------------------------------------
                                                                             1
(1 row)

select decode(to_number('NaN'),'NaN',4,5) from dual;
 DECODE(TO_NUMBER('NAN'),'NAN',4,5) 
------------------------------------
                                  4
(1 row)

select decode(exp(2),tanh(2),'4',exp(2),3) from dual;
 DECODE(EXP(2),TANH(2),'4',EXP(2),3) 
-------------------------------------
                                   3
(1 row)

select decode(to_date('2007-1-1','yyyy-mm-dd'),'2007-1-1',1,0) from dual;
 DECODE(TO_DATE('2007-1-1','YYYY-MM-DD'),'2007-1-1',1,0) 
---------------------------------------------------------
                                                       0
(1 row)

select decode(to_date('2007-1-1','yyyy-mm-dd'),to_date('2007-1-1','yyyy-mm-dd'),1,0) from dual;
 DECODE(TO_DATE('2007-1-1','YYYY-MM-DD'),TO_DATE('2007-1-1','YYYY-MM-DD'),1,0) 
-------------------------------------------------------------------------------
                                                                             1
(1 row)

select decode(3,null,4,5) from dual;
 DECODE(3,NULL,4,5) 
--------------------
                  5
(1 row)

select decode(3,'',4,5) from dual;
 DECODE(3,'',4,5) 
------------------
                5
(1 row)

select decode(null,null,4,5) from dual;
 DECODE(NULL,NULL,4,5) 
-----------------------
                     4
(1 row)

select decode(null,3,4,5) from dual;
 DECODE(NULL,3,4,5) 
--------------------
                  5
(1 row)

select decode(3,0,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3) from dual;
 DECODE(3,0,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,33,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3) 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        3
(1 row)

select to_char(trunc(to_char(decode(20, 0,0,10/20)),4) * 100,'fm9999990.00')  from dual;
 TO_CHAR(TRUNC(TO_CHAR(DECODE(20, 0,0,10/20)),4) * 100,'FM9999990.00') 
-----------------------------------------------------------------------
 50.00
(1 row)

--http://10.20.16.216:9090/ADB/AntDB/issues/777
create table t_decode( name varchar(100));
insert into t_decode values('1');
insert into t_decode values('1212');
select decode(name,null,2,name) from t_decode;
 DECODE(NAME,NULL,2,NAME) 
--------------------------
                        1
                     1212
(2 rows)

create or replace view test_view as select decode(name,null,2,name) nn from t_decode ;
select * from test_view;
  NN  
------
    1
 1212
(2 rows)

drop view test_view;
drop table t_decode;
create table t_decode (id integer,d1 date,d2 date,t varchar(1024),v varchar2(40),nv nvarchar2(40),c char,n numeric,si smallint,bi number(20,0),c2 char,i integer,vc varchar(20));
insert into t_decode values(1,to_date('2020-02-13 12:12:12' , 'yyyy-mm-dd hh24:mi:ss'),to_date('2019-2-26 11:14:25' , 'yyyy-mm-dd hh24:mi:ss'),'2020-02-13 12:12:12','2020-02-13 12:12:12','2020-02-13 12:12:12','1',1,2,3,'1',1,'2020-02-13 12:12:12');
insert into t_decode values(2,to_date('2020-02-13 12:12:12' , 'yyyy-mm-dd hh24:mi:ss'),to_date('2019-2-26 11:14:25' , 'yyyy-mm-dd hh24:mi:ss'),'1','0','1','0',1,0,1,'1',0,'1');
--character varying | oracle.date       | oracle.date
select vc,d1,decode(vc,d1,1,0) from t_decode where id =1;
         VC          |         D1          | DECODE(VC,D1,1,0) 
---------------------+---------------------+-------------------
 2020-02-13 12:12:12 | 2020-02-13 12:12:12 |                 1
(1 row)

--text              | oracle.date       | oracle.date
select t,d2,decode(t,d2,1,0) from t_decode where id =1;
          T          |         D2          | DECODE(T,D2,1,0) 
---------------------+---------------------+------------------
 2020-02-13 12:12:12 | 2019-02-26 11:14:25 |                0
(1 row)

--oracle.varchar2   | oracle.date       | oracle.date
select v,d2,decode(v,d2,1,0) from t_decode where id =1;
          V          |         D2          | DECODE(V,D2,1,0) 
---------------------+---------------------+------------------
 2020-02-13 12:12:12 | 2019-02-26 11:14:25 |                0
(1 row)

--oracle.nvarchar2  | oracle.date       | oracle.date
select nv,d2,decode(nv,d2,1,0) from t_decode where id =1;
         NV          |         D2          | DECODE(NV,D2,1,0) 
---------------------+---------------------+-------------------
 2020-02-13 12:12:12 | 2019-02-26 11:14:25 |                 0
(1 row)

--oracle.date       | character varying | oracle.date
select d2,v,decode(d2,v,1,0) from t_decode where id =1;
         D2          |          V          | DECODE(D2,V,1,0) 
---------------------+---------------------+------------------
 2019-02-26 11:14:25 | 2020-02-13 12:12:12 |                0
(1 row)

--oracle.date       | text              | oracle.date
select d1,t,decode(d1,t,1,0) from t_decode where id =1;
         D1          |          T          | DECODE(D1,T,1,0) 
---------------------+---------------------+------------------
 2020-02-13 12:12:12 | 2020-02-13 12:12:12 |                1
(1 row)

--oracle.date       | oracle.varchar2   | oracle.date
select d2,v,decode(d2,v,1,0) from t_decode where id =1;
         D2          |          V          | DECODE(D2,V,1,0) 
---------------------+---------------------+------------------
 2019-02-26 11:14:25 | 2020-02-13 12:12:12 |                0
(1 row)

--oracle.date       | oracle.nvarchar2  | oracle.date
select d1,nv,decode(d1,nv,1,0) from t_decode where id =1;
         D1          |         NV          | DECODE(D1,NV,1,0) 
---------------------+---------------------+-------------------
 2020-02-13 12:12:12 | 2020-02-13 12:12:12 |                 1
(1 row)

--text              | numeric           | numeric
 select t,n,decode(t,n,1,0) from t_decode where id =2;
 T | N | DECODE(T,N,1,0) 
---+---+-----------------
 1 | 1 |               1
(1 row)

--"char"            | numeric           | numeric
 select c,n,decode(c,n,1,0) from t_decode where id =2;
 C | N | DECODE(C,N,1,0) 
---+---+-----------------
 0 | 1 |               0
(1 row)

--character varying | numeric           | numeric
 select c2,n,decode(c2,n,1,0) from t_decode where id =2;
 C2 | N | DECODE(C2,N,1,0) 
----+---+------------------
 1  | 1 |                1
(1 row)

--oracle.varchar2   | numeric           | numeric
 select vc,n,decode(vc,n,1,0) from t_decode where id =2;
 VC | N | DECODE(VC,N,1,0) 
----+---+------------------
 1  | 1 |                1
(1 row)

--oracle.nvarchar2  | numeric           | numeric
 select nv,n,decode(nv,n,1,0) from t_decode where id =2;
 NV | N | DECODE(NV,N,1,0) 
----+---+------------------
 1  | 1 |                1
(1 row)

--numeric           | text              | numeric
 select n,t,decode(n,t,1,0) from t_decode where id =2;
 N | T | DECODE(N,T,1,0) 
---+---+-----------------
 1 | 1 |               1
(1 row)

--numeric           | "char"            | numeric
 select n,c,decode(n,c,1,0) from t_decode where id =2;
 N | C | DECODE(N,C,1,0) 
---+---+-----------------
 1 | 0 |               0
(1 row)

--numeric           | character varying | numeric
select n,vc,decode(n,vc,1,0) from t_decode where id =2;
 N | VC | DECODE(N,VC,1,0) 
---+----+------------------
 1 | 1  |                1
(1 row)

--numeric           | oracle.varchar2   | numeric
select n,v,decode(n,v,1,0) from t_decode where id =2;
 N | V | DECODE(N,V,1,0) 
---+---+-----------------
 1 | 0 |               0
(1 row)

--numeric           | oracle.nvarchar2  | numeric
select n,nv,decode(n,nv,1,0) from t_decode where id =2;
 N | NV | DECODE(N,NV,1,0) 
---+----+------------------
 1 | 1  |                1
(1 row)

--numeric           | smallint          | numeric
select n,si,decode(n,si,1,0) from t_decode where id =2;
 N | SI | DECODE(N,SI,1,0) 
---+----+------------------
 1 |  0 |                0
(1 row)

--numeric           | integer           | numeric
select n,i,decode(n,i,1,0) from t_decode where id =2;
 N | I | DECODE(N,I,1,0) 
---+---+-----------------
 1 | 0 |               0
(1 row)

--numeric           | bigint            | numeric
select n,bi,decode(n,bi,1,0) from t_decode where id =2;
 N | BI | DECODE(N,BI,1,0) 
---+----+------------------
 1 |  1 |                1
(1 row)

--smallint          | numeric           | numeric
select si,n,decode(si,n,1,0) from t_decode where id =2;
 SI | N | DECODE(SI,N,1,0) 
----+---+------------------
  0 | 1 |                0
(1 row)

--integer           | numeric           | numeric
select i,n,decode(i,n,1,0) from t_decode where id =2;
 I | N | DECODE(I,N,1,0) 
---+---+-----------------
 0 | 1 |               0
(1 row)

--bigint            | numeric           | numeric
select bi,n,decode(bi,n,1,0) from t_decode where id =2;
 BI | N | DECODE(BI,N,1,0) 
----+---+------------------
  1 | 1 |                1
(1 row)

--character         | numeric           | numeric
select c,n,decode(c,n,1,0) from t_decode where id =2;
 C | N | DECODE(C,N,1,0) 
---+---+-----------------
 0 | 1 |               0
(1 row)

--numeric           | character         | numeric
select n,c,decode(n,c,1,0) from t_decode where id =2;
 N | C | DECODE(N,C,1,0) 
---+---+-----------------
 1 | 0 |               0
(1 row)

drop table t_decode;
